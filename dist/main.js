(()=>{var e={353:()=>{}},t={};function n(o){var l=t[o];if(void 0!==l)return l.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}(()=>{"use strict";const e=panes.UI.rdf,t=panes.UI.store,o=e.fetcher(t),l=e.Namespace("http://www.w3.org/2000/01/rdf-schema#"),r=e.Namespace("http://www.w3.org/2002/07/owl#"),i=e.Namespace("http://xmlns.com/foaf/0.1/"),a=e.Namespace("http://www.w3.org/ns/solid/terms#"),s=e.Namespace("http://www.w3.org/ns/pim/space#"),c=e.Namespace("http://www.w3.org/ns/ldp#"),d=e.Namespace("http://www.w3.org/2006/vcard/ns#");function p(e,t,n){t=e.sym(t);let o=e.any(t,n);return o?o.value:""}function u(e,t,n){t=e.sym(t);let o=e.each(t,n),l=[];for(let e of o)l.push(e?e.value:"");return l}async function y(e,n){e||=document;let y=window.origin;n||=`${y}/profile/card#me`;const h=(n=await async function(e){await o.load(e);let n=t.each(e,l("seeAlso"));n=n.concat(t.each(e,r("sameAs"))),n=n.concat(t.each(e,i("primaryTopicOf")));for(let e of n)await o.load(e);return{webId:e,name:p(t,e,i("name"))||p(t,e,d("fn"))||"",nick:p(t,e,i("nick"))||"",image:p(t,e,d("hasPhoto"))||"",inbox:p(t,e,c("inbox"))||"",preferences:p(t,e,s("preferencesFile"))||"",privateTypeIndex:p(t,e,a("privateTypeIndex"))||"",publicTypeIndex:p(t,e,a("publicTypeIndex"))||"",storages:u(t,e,s("storage"))||"",issuers:u(t,e,a("oidcIssuer"))||""}}(n)).storages?n.storages[0]:null;n.name=n.name||n.nick||n.webId;let m=e.querySelectorAll("#currentPodMenu LI");for(let e of m){let t;try{t=new URL(e.name)}catch(e){}if(!t)continue;let o=t.pathname.replace(/^\//,""),l=t.hash||"";o.match(/Documents/i)?e.name=h.replace(/\/$/,"")+l:o.match(/Inbox/i)?e.name=n.inbox:o.match(/profile/i)?e.name=n.webId:e.name=h+o+l}let f=e.querySelector("#currentPodLogo");f&&(f.src=n.image);let g=e.querySelector("#currentPodTitle");return g&&(g.innerHTML=`${n.name}'s Pod`),solidUI.vars={podRoot:h,podName:n.name,podNick:n.nick,podWebid:n.webId,podImage:n.image,podInbox:n.inbox,podProfile:n.webId},console.log(solidUI.vars),n}function h(e,t){if(!e)return;const n=e.querySelectorAll("A");for(var o of n)o.classList.contains("skipMunge")||(o.addEventListener("click",(async e=>{e.preventDefault();let t=e.target.closest(".solid-uic-app");t=t.querySelector(".main");let n=e.target.href||e.target.parentElement.href;displayLink(null,{href:n,needsIframe:!0},t)})),t||(o.style="display:block;text-decoration:none;padding:0.5em; border-bottom:1px solid grey;"));return e}String.prototype.interpolate=function(e){const t=Object.keys(e),n=Object.values(e);return new Function(...t,`return \`${this}\`;`)(...n)},window.openModal=function(e,t){e.parentElement.children[1].style.display="block"},window.closeModal=function(e,t){e.parentElement.parentElement.style.display="none"},window.displayLink=async function(e,t,n){if("string"==typeof t&&(t={href:t}),t.href=t.href||t.link,t.type=t.type||"Link",t.type=t.type.replace(/http:\/\/www.w3.org\/ns\/ui#/,""),t.popout){let e=await solidUI.processComponent("",t.href);return e.style.display="block",document.body.appendChild(e),e}if(alert(1),t.type.startsWith("SolidOS")){alert(2),document.getElementById("mainMain").style.display="none";const e=document.getElementById("suicTabulator");let n;e.style.display="block";let o=t.href;return t.pane?n=panes.byName(t.pane):t.pod&&(o=(await y(null,t.pod)).storages[0]),o=window.kb.sym(o),function(e){const t=new URLSearchParams(location.search);t.set("uri",e||""),window.history.replaceState({},"",`${location.origin}${location.pathname}?${t}`)}(o.uri),void window.outliner.GotoSubject(o,!0,n,!0,null,e)}let o,l=document.getElementById("mainMain"),r=document.getElementById("suicTabulator");l&&(l.style.display="block"),r&&(r.style.display="none"),n&&!e&&(o=n);let i=e&&e.target?e.target.closest(".solid-uic-app"):null;i&&i.classList.contains("solid-main-app")?o=i.querySelector("#mainMain"):i&&(o=i.querySelector(".main")),o=o||document.body.querySelector(".main")||document.body,o&&(o.innerHTML="");let a=t.content;if(a){let e=document.createElement("SPAN");return a=a.interpolate(solidUI.vars),e.innerHTML=a,o.innerHTML="",o.appendChild(e),await solidUI.initInternal(o)}if("SolidOSLink"!==t.type){if("Feed"===t.type||"Feed"===t.linkType){let e={type:"App",orientation:"vertical",menu:t},n=await solidUI.processComponent("","",e);return n=h(n,"noStyle"),o.innerHTML="",o.appendChild(n),o}if("TransformLink"===t.type){if(t.href&&t.format&&t.format.match(/markdown/))return async function(e,t){let n=await fetch(e.href);n=await n.text(),t.innerHTML="";let o=document.createElement("SPAN");return o.innerHTML="\n<style>\n  h1 {display:none;}\n//  a{text-decoration:none; padding-top:0.25em;display:inline-block;padding-left:1em;}\n  ul {list-style:none;padding-left:0;margin-top:0;}\n</style>"+marked.parse(n),o=h(o,"noStyle"),o}(t,o)}else{if("Link"!==t.type){if(a=await solidUI.processComponent("",t),t.format||(a=h(a)),o.innerHTML="","string"==typeof a){let e=document.createElement("DIV");e.innerHTML=a,o.appendChild(e)}else o.appendChild(a);return o}if(a)return o.innerHTML=a,await this.initInternal(o);if(t.script){let e=await Function('"use strict";return ('+t.script+")")();return e=h(e),e}if(t.href){let e=await async function(e,t,n){let o=e.href;const l=document.createElement("IFRAME");if(l.style="width:100%;height:90vh;border:none;margin:0;padding:0;",l.src="",n)l.src=o;else try{let e=await fetch(o);if(e){e=await e.text(),t.innerHTML="",o=o.replace(/^.*proxy\?uri=/,""),o=new URL(o);const n=`<base href="${o.origin}/"><base target="_BLANK">`;l.srcdoc=`<body>${n}${e}</body>`,l.scrollTo({top:0,behavior:"smooth"})}else console.log("Fetched but no content!")}catch(e){console.log("Couldn't fetch!",e)}return l}(t,o,t.nativeIframe);return o.appendChild(e),o}}}};class m{async fetchAndParse(e,t){t=encodeURI(t),t=(e.proxy||"")+t;let n=await fetch(t),o=await n.text(),l=(new window.DOMParser).parseFromString(o,"text/xml"),r=l.querySelectorAll("item")||null;r=r.length<1?l.querySelectorAll("entry"):r;let i=[];return r.forEach((e=>{let t=e.querySelector("link").innerHTML;t||(t=e.querySelector("link").getAttribute("href")),t&&!t.match(/ /)||(t=e.querySelector("content").innerHTML.replace(/.*\[link\]/,"").replace(/a href="/,"").replace(/"&gt;.*/,"").replace(/.*&lt;/,"")),t.match(/^http/)||(t=t.replace(/.*\[CDATA\[/,"")),t=t.replace(/^http:/,"https:");let n=e.querySelector("title").innerHTML;n=n.replace(/^\<\!\[CDATA\[/,""),n=n.replace(/\]\].*\>/,"").trim(),i.push({title:n,link:t})})),i}async render(e,t){let n="",o=UI.icons.iconBase+"/noun_189137.svg";o=`<img src="${o}" style="width:1.2em;height:1.2em;display:inline-block; padding-left:0.4em;">`;for(let l of await this.fetchAndParse(e,t.href||t.link))"window"===t.displayTarget?n+=`\n          <li about="${l.link}" typeof="rss:item">\n            <a href="${l.link}" target="_BLANK" property="rss:title">\n              ${l.title}\n            </a>\n          </li>\n        `:n+=`\n          <li about="${l.link}" typeof="rss:item" style="display:none;background:green;border:1px solid grey;">\n            <a href="${l.link}" class="skipMunge" target="_BLANK" class="external">${o}</a>\n            <a href="${t.proxy+l.link}" property="rss:title">\n              ${l.title}\n            </a>\n          </li>\n        `;const l=document.createElement("DIV");l.property="xmlns:rss",l.content="http://purl.org/rss/1.0/",t.standAlone?(l.innerHTML=`\n        <div about="${t.href}" typeof="rss:channel">\n          <b property="rss:title">${t.label}</b>\n          <ul typeof="rss:items" style="display:table">\n            ${n}\n          </ul>\n        </div>\n    `,l.querySelector("B").style=`padding:1em;padding-right:0;background:${t.selBackground};color:${t.selColor};border:1px solid grey;width:100%;display:inline-block`,l.querySelector("UL").style=`padding:0;border:1px solid grey;border-top:none;list-style:none;margin-top:0;width:100%;height:${t.height};overflow-y:auto`):(l.innerHTML=`\n        <div about="${t.href}" typeof="rss:channel">\n          <div property="title" style="background:#d0d0d0;padding:1em;">${t.label}</div>\n          <ul typeof="rss:items" style="display:table">\n            ${n}\n          </ul>\n        </div>\n    `,l.querySelector("UL").style="padding:0;padding-left:0;list-style:none;margin-top:0;width:100%;");let r=l.querySelectorAll("A");for(let e of r)e.style="text-decoration:none;";let i=l.querySelectorAll("LI");for(let e of i)e.style="padding:1em;padding-bottom:0.75em;border-bottom:1px solid grey";return t.width&&(l.style.width=t.width),l}}class f{async render(e,t){const n=t.parts,o=e.createElement("DIV","accordion");if(!n||!n.length)return o;for(let l of n){let n=e.createElement("DIV"),r=e.createElement("DIV",""),i=e.createElement("SPAN","",l.label||l.topic);i.style.display="table-cell",i.style.width="100%",r.appendChild(i);let a=e.createElement("SPAN","caret-down","âŒ„");a.style.display="table-cell",a.textAlign="right",r.appendChild(a),r.style.backgroundColor=t.unselBackground,r.style.color=t.unselColor,r.style.padding="0.75em",r.style.border="1px solid grey",r.style.cursor="pointer";let s=e.createElement("DIV");if(l.content)s.innerHTML=l.content;else{console.log(t);for(let t=0;t<l.linkLabel.length;t++){let n=l.linkLabel[t],o=l.linkUrl[t],r=e.createElement("BUTTON","",n);r.setAttribute("data-link",o),r.style.width="100%",r.style.border="none",r.style.background="transparent",r.style.marginBottom="0.25em",r.style.cursor="pointer",r.onclick=e=>{showByClass(e)},s.appendChild(r)}}s.style.padding="0.75em",s.style.border="1px solid grey",s.style.borderTop="none",s.style.display="none",r.onclick=e=>{let t="block"===s.style.display,n=o.children;for(let e of n)e.children[1].style.display="none";s.style.display=t?"none":"block"},s.style.backgroundColor=t.background,s.style.color=t.color,n.appendChild(r),n.appendChild(s),n.style.marginBottom="1em",o.appendChild(n)}return e.simulateClick(o.querySelector("DIV DIV DIV")),await e.initInternal(o)}}class g{async render(e,t){function n(e){let t=function(){let e=document.createElement("DIV");e.style="height:1rem",document.body.appendChild(e);let t=e.clientHeight;return document.body.removeChild(e),t}();return e.menuHeight=2*t,window.SolidAppContext={scroll:e.headerHeight},e.headerHeight=6*t,e.mainHeight=window.innerHeight-e.headerHeight,e.headerHeight=e.headerHeight.toString()+"px",e.mainHeight=e.mainHeight.toString()+"px",e}(t=e.setDefaults(t)).fullPage&&(window.addEventListener("resize",(()=>{t=n(t);let e=document.getElementById("mainMain"),o=document.getElementById("suicTabulator");e&&(e.style.height=t.mainHeight),o&&(o.style.height=t.mainHeight)})),document.body.style.overflow="hidden"),t=n(t),t.logo||="",t.title||="",t.headerHeight=t.logo||t.title||t.adminMenu?t.headerHeight:"0",t.leftMenu="",t.siteMenu="","horizontal"===t.orientation?t.leftMenuStyle="display:none":t.leftMenuStyle=`\n        display:block;\n        width:36vw !important;\n        height:${t.mainHeight};\n        overflow-y:scroll;\n        margin:0;\n        padding:0;\n      `;let o=await this.getHTML(t),l=e.createElement("SPAN","",o),r=l.querySelector("#solidLogo");r&&(r.src="https://solidproject.org/assets/img/solid-emblem.svg");let i=l.querySelector("#currentPodMenu");"vertical"===t.orientation&&(i=l.querySelector("NAV"));const a=await e.processComponent(i,t.currentPodMenu);if(i&&i.appendChild(a),t.userMenu){const n=await e.processComponent(i,t.userMenu);let o=l.querySelector("#userMenu");o&&o.appendChild(n)}if(t.loginBox&&await async function(e){const t=e.querySelector("#loginArea"),n=panes.UI;async function o(e){await async function(){n.authn.currentUser()||await n.authn.checkUser()}(),t.innerHTML="",t.appendChild(n.authn.loginStatusBox(document,null,{}));let o=t.querySelectorAll("input");o[0].value=o[0].value.replace(/WebID\s*/,""),o[1]&&(o[1].style.display="none")}e.querySelector("#suicTabulator").style="\n        display: none; /* Hidden by default */\n        position: fixed; /* Stay in place */\n        z-index: 1; /* Sit on top */\n        left: 0;\n        top: 10vh;\n        /* height: set in app.js */\n        width: 100%; /* Full width */\n        overflow: auto; /* Enable scroll if needed */\n        background-color: rgb(0,0,0); /* Fallback color */\n        background-color: rgba(0,0,0,0.2); /* Black w/ opacity */\n      ",n.authn.authSession&&(n.authn.authSession.onLogin((()=>{o()})),n.authn.authSession.onLogout((()=>{o()})),n.authn.authSession.onSessionRestore((e=>{o()}))),o()}(l),await y(l),t.initialContent){let n=await e.getComponentHash(t.initialContent);n=n.content.interpolate(e.vars);let o=l.querySelector("#mainMain");o&&(o.innerHTML=n)}return l}rem2vw(e){return e*(100/document.body.clientWidth)}rem2vh(e){return 16*e*(100/window.innerHeight)}async getHTML(e){if(e.leftColumnColumnStyle||="display:none",e.leftColumnColumnMenu||="",e.siteMenu||="",e.leftColumnColumnStyle||="",e.iframeSrc||="",e.iframeContent||="",e.logoStyle="\n             height: 3rem;\n            display: inline-block;\n       padding-left: 0.5rem;\n     ",e.titleStyle='\n       display:inline-block;\n       vertical-align:top; align:left;\n       font-size: 2rem;\n       padding-top: 0.4rem;\n       padding-left:1rem;"\n     ',e.appStye="\n              display: flex;\n       flex-direction: column;\n                width: 100%;\n               height: 100%;\n     ",e.mainStyle=`\n        padding:0rem;\n        width:100%;\n        overflow:scroll;\n        position:absolute;\n        top:${e.headerHeight} !important;\n        left:0;\n        height:${e.mainHeight};\n     `,e.theme)try{let t=await window.fetch(e.theme),n=await t.text();return n=solidUI.fillTemplate(n,[e]),await n}catch(e){console.log(e)}return`\n\x3c!--APP--\x3e\n<div class="solid-uic-app solid-main-app">\n\n    \x3c!--BANNER--\x3e\n    <div class="app-banner">\n\n        \x3c!--USER IMAGE & NAME--\x3e  \n        <img id="currentPodLogo" src="">\n        <div id="currentPodTitle"></div>\n\n\n        \x3c!--ADMIN MENU, LOGIN, SOLID LOGO--\x3e\n        <div style="background:${e.unselBackground};text-align:center;position:absolute;top:0.5rem;right:7rem;"><span id="adminMenu" style="white-space: nowrap;"></span> </div>\n        <div id="loginArea"></div>\n        <img src="${e.logo}" style="height:7rem;position:absolute;top:-0.5rem;right:-0.5rem">\n\n        \x3c!--PUBLIC MENU--\x3e\n        <div id="currentPodMenu" style="white-space:nowrap;position:absolute;top:3rem;left:7.4rem;">${e.siteMenu}</div>\n\n    </div>\x3c!--BANNER--\x3e\n\n    \x3c!--MAIN WRAPPER--\x3e\n\x3c!--    <div style="display:flex;flex-direction:row;width:100%;height:100%;"> --\x3e\n    <div style="width:100%;height:100%;min-height:0;">\n\n        \x3c!-- LEFT COLUMN MENU (IF EXISTS) --\x3e\n        <div class="leftColumn" style="${e.leftMenuStyle}">${e.leftMenu}</div>\n\n        \x3c!--MAIN MAIN--\x3e\n        <div id="mainMain" style="min-height:0;${e.mainStyle}"></div>\n\n        \x3c!--MAIN TABULATOR--\x3e\n            <div class="TabulatorOutline" role="main" id="suicTabulator" style="${e.mainStyle}">\n                <table id="outline"></table>\n                <div id="GlobalDashboard"></div>\n            </div>\n\n    </div>\x3c!--MAIN WRAPPER--\x3e\n\n</div>\x3c!--APP--\x3e\n<style>\n  #suicTabulator{\n    top:${e.headerHeight} !important;\n    overflow:scroll !important;\n    min-height: 0; \n  }\n  #suicTabulator table {\n    background:#7e7e7e !important;\n    color:white !important;\n  }\n  .solid-main-app {\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n  }\n  .solid-main-app .app-banner {\n     width:100%;\n     display:flex;\n     background:${e.unselBackground};\n     color:black;\n  }\n  .solid-main-app input[type="button"]:hover {\n    background:${e.selBackground};\n    color:${e.selColor};\n  }\n  .solid-main-app #currentPodTitle {\n    left:8rem;\n    font-size:1.3rem;\n    position:absolute;\n    top:1rem;\n  }\n  .solid-main-app #currentPodLogo {\n    height:${e.headerHeight}\n  }\n</style>\n\n    `}}class w{async render(e,t){const n=document.createElement("DIV","uic-form"),o=window.document,l=await e.loadUnlessLoaded(t.form);await e.loadUnlessLoaded(t.formSubject);const r=await e.loadUnlessLoaded(t.formSubject);if(!r)return console.log("ERROR : Couldn not load form subject ",t.formSubject);let i=t.formResultDocument;!i&&r.doc&&(i=r.doc());const a=t.script||function(){};try{UI.widgets.appendForm(o,n,{},r,l,i,a)}catch(e){return console.log(e)}if(t.onchange){const e=n.querySelectorAll(".formFieldValue button");for(let t of e)t.onclick="alert(3)"}return n}}class b{async render(e,t,n){"string"==typeof t&&(t=await e.processComponent(n,t));let o=e.createElement("NAV","solid-uic-dropdown-menu"),l=document.createElement("UL"),r=document.createElement("DIV");for(var i of(o.style.background=t.unselBackground,o.style.color=t.unselColor,r.style.width="100%",r.style.backgroundColor=t.background,r.style.color=t.color,r.innerHTML="",r.classList.add("main"),o.appendChild(l),t.parts))l.appendChild(await this.renderMenuItem(i,t,r));const a=e.createElement("SPAN");return o.style.display="inline-block",o.style.textAlign=t.position,l.style.textAlign=t.position,a.appendChild(o),a.appendChild(r),a}async renderMenuItem(e,t,n){if(e.menu&&e.menu.type&&"SparqlQuery"===e.menu.type){let t=await solidUI.processComponent(null,null,e.menu);"object"==typeof t&&(e.parts=t)}const o=document.createElement("LI"),l=document.createElement("SPAN");if(l.innerHTML=e.label,o.appendChild(l),o.style.cursor="pointer",o.style.display="inline-block",o.style.backgroundColor=t.unselBackground,o.style.color=t.unselColor,o.onmouseover=()=>{o.style.backgroundColor=t.selBackground,o.style.color=t.selColor},o.onmouseout=()=>{o.style.backgroundColor=t.unselBackground,o.style.color=t.unselColor},e.popout||!e.parts)o.classList.add("item"),o.name=e.href,o.onclick=t=>{e.href=t.target.parentElement.name,window.displayLink(t,e,n)};else{o.classList.add("caret");let l=document.createElement("UL");for(var r in o.appendChild(l),l.classList.add("nested"),e.parts){let o=e.parts[r];"object"==typeof o&&(o.target=t.target),l.appendChild(await this.renderMenuItem(o,t,n))}}return o}}class k{async render(e,t){const n=document.createElement("SPAN"),o=`\n      background-color:${(a=t).unselBackground};\n      color:${a.unselColor};\n      padding:1rem;\n      cursor:pointer;\n    `,l="\n      display: none; /* Hidden by default */\n      position: fixed; /* Stay in place */\n      z-index: 1; /* Sit on top */\n      left: 0;\n      top: 0;\n      width: 100%; /* Full width */\n      height: 100%; /* Full height */\n      overflow: auto; /* Enable scroll if needed */\n      background-color: rgb(0,0,0); /* Fallback color */\n      background-color: rgba(0,0,0,0.2); /* Black w/ opacity */\n    ",r=`\n      background-color: #fefefe;\n      margin: 15% auto; /* 15% from the top and centered */\n      padding: 1rem;\n      border: 1px solid #888;\n      border-radius:0.5rem;\n      width: ${a.width};\n    `,i="\n      color:red;\n      text-align:right;\n      margin-bottom: 0.25rem;\n      font-size: 2rem;\n      font-weight: bold;\n      cursor:pointer;\n    ";var a;return n.innerHTML=`\n      <button style="${o}" onclick="window.openModal(this)">\n        ${t.label}\n      </button>\n      <div style="${l}">\n        <div style="${r}">\n          <div style="${i}" onclick="window.closeModal(this)">\n            &times;\n          </div>\n          ${t.content}\n        </div>\n      </div>\n    `,await e.initInternal(n)}}var C=n(353);class v{render(e){const t=e.parts;if(!t||!t.length)return console.log("No results!"),document.createElement("SPAN");let n=document.createElement("TABLE"),o=Object.keys(t[0]),l=document.createElement("TR");for(let t of o){let n=document.createElement("TH");n.innerHTML=t,n.style.border="1px solid black",n.style.padding="0.5em",n.style.background=e.unselBackground,n.style.color=e.unselColor,l.appendChild(n)}n.appendChild(l);for(let l of t){let t=document.createElement("TR");for(let n of o){let o=document.createElement("TD");o.innerHTML=l[n],o.style.border="1px solid black",o.style.padding="0.5em",o.style.backgroundColor=e.background,o.style.color=e.color,t.appendChild(o)}n.appendChild(t)}return n.style.borderCollapse="collapse",n}}class S{async render(e,t){const n=t.parts,o=e.createElement("DIV","solid-uic-tabs");t.style&&(o.style=t.style);const l=e.createElement("NAV");"vertical"===t.orientation?l.style.textAlign="right":l.style.textAlign=t.position;let r=e.createElement("DIV");r.style.backgroundColor=t.background,r.style.color=t.color;let i=0;for(let a of n){i++;let n=e.createElement("BUTTON",i,a.label);n.style.backgroundColor=t.unselBackground,n.style.color=t.unselColor,n.style.padding="0.75em",n.style.border="1px solid grey",n.style.cursor="pointer";let s=e.createElement("DIV",i,a.content);if(s.style.padding="0.75em","horizontal"===t.orientation&&(s.style.border="1px solid grey"),s.style.display="none","SolidOSLink"===a.type){let e=`tab-${i}-outline`;s.innerHTML=`\n          <div class="TabulatorOutline" id="${e}-tabulator" role="main">\n            <table id="${e}"></table>\n            <div id="GlobalDashboard"></div>\n          </div>\n        `;let t=window.kb.sym(a.href),n=s.querySelector("#"+e);n.style="display:table-row;background-color:c0c0c0",window.outliner.GotoSubject(t,!0,void 0,!0,void 0,n)}n.onclick=e=>{e.preventDefault();let r=o.querySelector("DIV").children;for(let e of r)e.style.display="none";for(let e of l.children)e.style.backgroundColor=t.unselBackground,e.style.color=t.unselColor;n.style.backgroundColor=t.selBackground,n.style.color=t.selColor,s.style.display="block"},l.appendChild(n),r.appendChild(s),"vertical"===t.orientation?(n.style.display="block",n.style.marginBottom="0.5em",n.style.width="100%",o.style.width="100%",o.style.height="100%",o.style.display="table-row",l.style.display="table-cell",r.style.display="table-cell",r.style.display="block",r.style.height="100%",s.style.height="100%"):(n.style.marginRight="0.5em",n.style.borderBottom="none")}o.appendChild(l);const a=document.createElement("SPAN");return a.style="\n        color:red;\n        text-align:right;\n        position:absolute;\n        top:0.25rem;\n        right:0.25rem;\n        font-size: 2rem;\n        font-weight: bold;\n        cursor:pointer\n      ",a.addEventListener("click",(e=>{e.preventDefault(),e.target.parentElement.style.display="none"})),a.innerHTML="&times",o.appendChild(a),o.appendChild(r),e.simulateClick(o.querySelector("BUTTON")),await e.initInternal(o)}}const x=new class{async rdflibQuery(e,t,n,o,l){await e.loadUnlessLoaded(n);try{const e=await $rdf.SPARQLToQuery(o,!1,t);let n=e.vars.map((e=>e.label)),l=[],r=t.querySync(e);for(let e of r){let t={};for(let o of n){let n=e["?"+o];t[o]=n?n.value:""}l.push(t)}return l=l.sort(((e,t)=>e.label>t.label?1:-1)),l}catch(e){console.log(e)}}async comunicaQuery(e,t){try{let n=Comunica.newEngine();function o(e){return e?e.replace(/^"/,"").replace(/"[^"]*$/,""):""}let l=await n.query(t,{sources:[e]}),r=l.variables;l=await l.bindings();let i=[];for(let e of l.entries()){if(!e[1]||!e[1]._root||!e[1]._root.entries)continue;e=e[1]._root.entries;let t={};for(let n in e){let l=o(e[n][0].replace(/^\?/,""));t[l]=t[l]||"";let r=o(e[n][1].id);"ARRAY"!=typeof t[l]&&(t[l]=[t[l]]),"ARRAY"==typeof t[l]?t[l].push(r):t[l]=r}for(let e of r)e=e.replace(/^\?/,""),t[e]=t[e]||"";i.push(t)}return i.length||console.log("No results!"),i}catch(e){console.log(e)}}flatten(e,t){const n={};for(let o of e){let e=o[t];n[e]||(n[e]={});for(let t of Object.keys(o))n[e][t]?n[e][t].includes(o[t])||("object"!=typeof n[e][t]&&(n[e][t]=[n[e][t]]),n[e][t].push(o[t])):n[e][t]=o[t]}e=[];for(let t of Object.keys(n))e.push(n[t]);return e}},L=panes.UI.rdf,M=window.kb=L.graph();let A;window.outliner=panes.getOutliner(document),L.Namespace("http://www.w3.org/2004/02/skos/core#");const I=L.Namespace("http://www.w3.org/ns/ui#"),T=L.Namespace("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),E=new class{constructor(){}async init(){const e=document.querySelectorAll("[data-solid_ui_component]");for(let t of e){const e=await this.processComponent(t);e&&t.appendChild(e)}}async initInternal(e){const t=e.querySelectorAll("[data-solid_ui_component]");for(let e of t){const t=await this.processComponent(e);e.appendChild(t)}return e}async processComponent(e,t,n){if(!n){if(!t&&e&&e.dataset&&(t=await this.loadUnlessLoaded(e.dataset.solid_ui_component)),!t)return null;n=await this.getComponentHash(t)}if(n||=t,!n)return void console.log("No ComponentHASH ",t);let o="string"==typeof(n=this.getDefaults(n)).dataSource?await this.getComponentHash(n.dataSource):n.dataSource;if(o&&"SparqlQuery"===o.type){let e=o.endpoint,t=o.query;if(n.parts=await this.sparqlQuery(e,t,n),"SparqlQuery"===n.type)return n.parts}if("SparqlQuery"===n.type&&(n.parts=await this.sparqlQuery(n.endpoint,n.query,n),"SparqlQuery"===n.type))return n.parts;if("AnchorList"===n.type)for(let e of n.content.split(/\n/));if(n.parts&&n.groupOn&&(n.parts=x.flatten(n.parts,n.groupOn),console.log(n.groupOn,n.parts)),"App"===n.type)return await(new g).render(this,n);if(n.type&&n.type.match(/Link/))return await window.displayLink(e,n,e);if("Menu"===n.type)return await(new b).render(this,n,e);if("Feed"===n.type&&(n.href||n.link))return await(new m).render(this,n);if("SelectorPanel"===n.type){let e=new C.SelectorPanel;return this.setDefaults(n),await e.render(n)}if("ModalButton"===n.type)return await(new k).render(this,n);if("Accordion"===n.type)return await(new f).render(this,n);if("FormComponent"===n.type)return await(new w).render(this,n);if("Tabset"===n.type)return await(new S).render(this,n);let l,r,i,a,s,c=document.createElement("DIV");"Record"===n.type&&(s=this.getValue(o,I("label")),a=this.getValue(o,I("content")),l={label:s,content:a}),l=l||n.parts,this.log("Parts for Component",l);let d,p=n.template;if(!p)return l;if(p.groupOn&&(l=x.flatten(l,p.groupOn)),"AccordionMenu"==p){let e=await this.runBuiltIn(p,l);return e&&c.appendChild(e),c}if("Table"==p){let e=await(new v).render(n);return e&&c.appendChild(e),c}if("ModalButton"==p){let e=await this.makeMmodal(n.label,n.content);return e&&c.appendChild(e),c}"string"==typeof p&&(p=await this.getComponentHash(p)),d=p.recurring,r=p.before,i=p.after;let u=this.fillTemplate(d,l);return c.innerHTML=(r||"")+u+(i||""),c}async getComponentHash(e,t){if(!(e=await this.loadUnlessLoaded(e)))return null;let n=M.match(e,null,null);e.doc&&M.match(null,null,null,e.doc()),t=t||{};for(let e of n){let n=e.predicate.value.replace(/http:\/\/www.w3.org\/1999\/02\/22-rdf-syntax-ns#/,"").replace(/http:\/\/www.w3.org\/ns\/ui#/,""),o=e.object;if("BlankNode"===o.termType)o=await this.getComponentHash(o),t[n]?"ARRAY"!=typeof t[n]?t[n]=[o]:t[n].push(o):t[n]=o;else if("Collection"===o.termType){o=o.elements;for(let e of o){let o=await this.getComponentHash(e,{});t[n]?t[n].push(o):t[n]=[o]}}else o=o.value.replace(/^http:\/\/www.w3.org\/ns\/ui#/,""),t[n]?"ARRAY"!=typeof t[n]?t[n]=[o]:t[n].push(o):t[n]=o;1==t[n].length&&(t[n]=t[n][0])}return t}log(...e){"undefined"!=typeof DEBUG&&console.log(e)}setStyle(e,t){for(let n of Object.keys(t))e.style[n]=t[n]}async sparqlQuery(e,t,n){return"undefined"!=typeof Comunica?await x.comunicaQuery(e,t,n):await x.rdflibQuery(E,M,e,t,n)}getDefaults(e){return"string"==typeof e&&(e=this.processComponent("",e)),e.height||=this.height,e.width||=this.width,e.proxy||=this.proxy||"https://solidcommunity.net/proxy?uri=",e.background||=this.background||"#fff",e.color||=this.color||"#000",e.selBackground||=this.selBackground||"#559",e.selColor||=this.selColor||"#fff",e.unselBackground||=this.unselBackground||"#99d",e.unselColor||=this.unselColor||"#000",e.orientation||=this.orientation||"horizontal",e.position||=this.position||"left",this.proxy=e.proxy,e}setDefaults(e){return"string"==typeof e&&(e=this.processComponent("",e)),this.background=e.background,this.color=e.color,this.selBackground=e.selBackground,this.selColor=e.selColor,this.unselBackground=e.unselBackground,this.unselColor=e.unselColor,this.orientation=e.orientation,this.position=e.position,this.proxy=e.proxy,this.getDefaults(e)}fillTemplate(e,t){function n(e,t){for(let n of Object.keys(t)){let o=t[n]||" ";"object"==typeof o&&o.length>1&&(o=o.join(", "));let l=new RegExp(`\\$\\{${n}\\}`,"gi");e=e.replace(l,o)}return e}let o="";for(let l of t)o+=n(e,l)+"\n";return o}runBuiltIn(e,t,n){return t.match(/Table/)?this.results2table(e,n):t.match(/Modal/)?this.results2modal(n):t.match(/Accordion/)?tabset(n):t.match(/DescriptionList/)?this.results2descriptionList(n):void 0}diff(e,t){e.split(t).join("")}simulateClick(e){if(e.fireEvent)e.fireEvent("onclick");else{var t=document.createEvent("Events");t.initEvent("click",!0,!1),e.dispatchEvent(t)}}createElement(e,t,n,o){let l=document.createElement(e);if(t&&l.classList.add(t),n&&(l.innerHTML=n),o)for(let e of o.split(/;/)){let t=e.split(/:/);2==t.length&&(l.style[t[0].trim()]=t[1].trim())}return l}getComponentType(e){return e?M.each(e,T("type")).map((e=>{if((e=e.value).match(/ns\/ui#/))return e.replace(/.*\#/,"")}))[0]||"":null}async clearInline(){for(let e of M.match())e.graph.value.startsWith("inline:")&&M.remove(e)}loadFromMemory(e){let t=e;if(M.any(null,null,null,L.sym(t)))return L.sym(t);let[n,o]=t.split(/#/),l=document.getElementById(n),r=l.innerText||l.value;r=r.trim(),r.startsWith("<![CDATA[")&&(r=r.replace(/^\<\!\[CDATA\[/,"").replace(/\]\]$/,"").replace(/~~/g,"#"));try{return L.parse(r,M,t,"text/turtle"),L.sym(t)}catch(e){console.log(e)}}async loadUnlessLoaded(e){try{if(e.termType&&"BlankNode"===e.termType)return e;if(!(e="object"==typeof e?e.uri:e))return;if(e.startsWith("inline"))return this.loadFromMemory(e);e.startsWith("http")||e.startsWith("ls")||(e=window.location.href.replace(/\/[^\/]*$/,"/")+e);const t=e.replace(/\#[^#]*$/,"");let n=L.sym(t);return M.any(null,null,null,n)?console.log(`<${n.uri}> already loaded!`):(console.log("loading "+n.uri+" ..."),A=A||L.fetcher(M),await A.load(n.uri),M.any(null,null,null,n)?console.log(`<${n.uri}> loaded!`):console.log(`<${n.uri}> could not be loaded!`)),L.sym(e)}catch(e){return console.log(e),null}}getValue(e,t,n,o){let l=M.any(e,t,n,o);return l?l.value:""}valuesContain(e,t,n,o,l){let r=M.each(e,t,n,o);for(let e of r)if(e=e?e.value:"",e===l)return e}};document.addEventListener("DOMContentLoaded",(()=>{E.init()}))})()})();